{% extends "app_base.html" %}

{% block content %}
<div id="pages-list">
    <div v-for="(page, index) in pages" style="display: inline-block;width: 30%; margin-left:1%">
      <div class="panel panel-info">
        <div class="panel-heading">
          <h3 class="panel-title">待校对面</h3>
        </div>
        <div class="panel-body">
          <a :href="/pages/ + page.id">[[page.id]]</a>
        </div>
      </div>

    </div>
</div>
{% endblock %}

{% block base_foot_script %}
<script type="text/javascript">
var final_val="{{ final_val }}";
window.vv=new Vue({
  el: '#pages-list',
  delimiters: ['[[', ']]'],
  data: {
    newLabel: '',
    pages: [],
    api_base: "/api/pages?final=",
    current_id: 0,
    current: {}
  },
  mounted: function() {
    this.loadPage();
  },
  methods: {
    loadPage: function() {
        var json_server_api = this.api_base + final_val;
        this.$http.get(json_server_api).then(function (response) {
            this.pages = response.data.models;
        }, function(error) {
          // error callback
          console.log('Fail，网址或相关错误！\n错误码：' + error.status + "\n结果：" + error.ok);
        });
    },
  }
})

  $(function() {
    if (final_val == "0") {
      $('.lt-menu .menu-content').first().find('.submenu').first().addClass('active');
    } else {
      $('.lt-menu .menu-content').first().find('.submenu').first().next().addClass('active');
    }
  });
</script>

{% endblock %}